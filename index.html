<!doctype html>
<html>
<head>
    <title>My Page</title>
    <meta name="viewport" content="width=320; user-scalable=no" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css">
    <link rel="stylesheet" href="css/main.css"/>
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    <style>
        #yourimage {
            width:100%;
        }

        #swatches {
            width: 100%;
            height: 50px;
        }

        .swatch {
            width:18%;
            height: 50px;
            border-style:solid;
            border-width:thin;
            float: left;
            margin-right: 3px;
        }
    </style>
</head>
<body>
    <div data-role="page" id="home">

        <div data-role="header">
            <h1>Quick SnAPP</h1>
        </div>

        <div data-role="content">
            <p>Camera Canvas</p>
            <input type="file" capture="camera" accept="image/*" id="takePictureField">

            <img id="yourimage">

            <div id="swatches">
                <div id="swatch0" class="swatch"></div>
                <div id="swatch1" class="swatch"></div>
                <div id="swatch2" class="swatch"></div>
                <div id="swatch3" class="swatch"></div>
                <div id="swatch4" class="swatch"></div>
            </div>
        </div>

        <div class="button-center" data-role="footer">
            <a id="capture" href="#" data-role="button" data-icon="star">Capture</a>
        </div>

    </div>
    <div data-role="page" id="detail">

        <div data-role="header">
            <a href="#home" data-role="button" data-icon="star" data-rel="back">Back</a>
            <h1>Quick SnAPP</h1>
        </div>

        <div data-role="content">
            <p>Boby Placeholder</p>
        </div>

        <div class="button-center" data-role="footer">
            <a href="#" data-role="button" data-icon="star">Submit</a>
        </div>

    </div>
    <script>
        var desiredWidth;

        $(document).ready(function() {
            console.log('onReady');
            $("#takePictureField").on("change",gotPic);
            $("#yourimage").load(getSwatches);
            desiredWidth = window.innerWidth;

            if(!("url" in window) && ("webkitURL" in window)) {
                window.URL = window.webkitURL;
            }

        });

        function getSwatches(){
            var colorArr = createPalette($("#yourimage"), 5);
            for (var i = 0; i < Math.min(5, colorArr.length); i++) {
                $("#swatch"+i).css("background-color","rgb("+colorArr[i][0]+","+colorArr[i][1]+","+colorArr[i][2]+")");
                console.log($("#swatch"+i).css("background-color"));
            }
        }

        //Credit: https://www.youtube.com/watch?v=EPYnGFEcis4&feature=youtube_gdata_player
        function gotPic(event) {
            if(event.target.files.length == 1 &&
                    event.target.files[0].type.indexOf("image/") == 0) {
                $("#yourimage").attr("src",URL.createObjectURL(event.target.files[0]));
            }
        }

    </script>
</body>
</html>